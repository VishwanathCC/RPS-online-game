<!DOCTYPE html>
<html>
    <head>
        <title>Rock Paper Scissors</title>     
        <style>
            body {
                background-color: black;
                color: white;
                font-family: Arial, Helvetica, sans-serif;
            }

            .move-button {
                background-color: transparent;
                border: 5px solid green;
                width: 120px;
                height: 120px;
                cursor: pointer;
                border-radius: 60px;
                margin-right: 10px;
            }

            .move-icon {
                height: 50px;
            }

            .js-score {
                font-size: 25px;
                font-weight: bold;
            }
        </style>   
    </head>
    <body>
        <!-- <p>Rock Paper Scissors</p> -->
        <p>Rock Paper Scissors... Just for my brother Neeal!</p>

        <button onclick="
        if(pickComputerMove()){
            // let result = '';
            if (computerMove == 'rock'){
                result = 'It\'s a tie';
                score.ties += 1;
            }else if (computerMove == 'paper'){
                result = 'You lose';
                score.losses += 1;
            }else {
                result = 'You win';
                score.wins += 1;
            }
            localStorage.setItem('score', JSON.stringify(score));
                alert(`You picked rock & computer picked ${computerMove}.\n${result}!`);                
        } else {
            alert(`That's all, Close the Tab and get back to work`);
        }
        location.reload();
        "  class = "move-button">
        <img src="images/rock-emoji.png" class="move-icon" > 
        </button>

        <button class = "move-button" onclick="
        if(pickComputerMove()){

        // let result = '';
        if (computerMove == 'rock'){
            result = 'You win';
            score.wins += 1;
        }else if (computerMove == 'paper'){
            result = 'It\'s a tie';
            score.ties += 1;
        }else {
            result = 'You loose';
            score.losses += 1;
        }
        localStorage.setItem('score', JSON.stringify(score));
            alert(`You picked paper & computer picked ${computerMove}.\n${result}!`);
    } else {
            alert(`That's all, Close the Tab and get back to work`);
        }
        location.reload();
    " class = "move-button">
        <img src="images/paper-emoji.png" class="move-icon"> 
    </button>

        <button class = "move-button" onclick="
        if (pickComputerMove()){

        // let result = '';
        if (computerMove == 'rock'){
            result = 'You loose';
            score.losses += 1;
        }else if (computerMove == 'paper'){
            result = 'You win';
            score.wins += 1;
        }else {
            result = 'It\'s a tie';
            score.ties += 1;
        }
        localStorage.setItem('score', JSON.stringify(score));
            alert(`You picked scissor & computer picked ${computerMove}.\n${result}!`);
    } else {
            alert(`That's all, Close the Tab and get back to work`);
        }
        location.reload();
    " class = "move-button">
        <img src="images/scissors-emoji.png" class="move-icon"> 
    </button>

    <p class="js-current-scene"></p>

    <p class="js-score">Score</p>

        <script>
            let computerMove;
            let lastPlayed;
            let score = JSON.parse(localStorage.getItem('score')) || {wins: 0, losses: 0, ties: 0};
            localStorage.setItem('score', JSON.stringify(score));
            // const score = JSON.parse(localStorage.getItem('score'));

            let result = '';
            function pickComputerMove() {
                const currentDate = new Date();
                if (sessionTimeManager() || score.wins + score.losses + score.ties > 14 ){
                    return false;
                }
                let randomNumber = Math.random();
                if (randomNumber > 0 && randomNumber < 1/3){
                    computerMove = `rock`;
                }else if (randomNumber > 1/3 && randomNumber < 2/3){
                    computerMove = `paper`;
                }else {
                    computerMove = `scissors`;
                }
                // console.log(`score: ${score.wins}, ${score.losses} , count: ${count}`)
                 return true;
            }

            function updateScore() {
                let results;
                if (score.wins > score.losses){
                results = `wins: ${score.wins}, losses: ${score.losses}, ties: ${score.ties} <br><br>You win`;
                } else if (score.losses === score.wins) {
                results = `wins: ${score.wins}, losses: ${score.losses}, ties: ${score.ties} <br><br>It's a tie`;
                }else{
                results = `wins: ${score.wins}, losses: ${score.losses}, ties: ${score.ties} <br><br>You loose`;
                }
                return results;
            }

            function sessionTimeManager() {
                // Check if a timestamp indicating the last access time exists in localStorage
                const lastAccessTimestamp = localStorage.getItem('lastAccessTimestamp');

                if (!lastAccessTimestamp) {
                // Grant access if no timestamp exists
                localStorage.setItem('lastAccessTimestamp', Date.now().toString());
                console.log('Access granted for the first time.');
                return true;
                } else {
                const currentTime = Date.now();
                const timeDifference = currentTime - parseInt(lastAccessTimestamp, 10);
                const fourHoursInMillis = 2 * 60 * 60 * 1000; // 2 hours in milliseconds

                if (timeDifference >= fourHoursInMillis) {
                    // Grant access if time difference is greater than or equal to 2 hours
                    localStorage.setItem('lastAccessTimestamp', currentTime.toString());
                    console.log('Access granted after 4 hours.');
                    score = {wins: 0, losses: 0, ties: 0};
                    localStorage.setItem('score', JSON.stringify(score));
                    return true;
                } else {
                    // Deny access if time difference is less than 2 hours
                    console.log('Access denied. Please wait for 4 hours.');
                    return false;
                }
                }
            }
            document.querySelector('.js-score').innerHTML = updateScore();
        </script>
    </body>
</html>